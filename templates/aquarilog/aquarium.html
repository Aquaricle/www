{% include "header_aquarilog.html" %}

<h2>{{ aquarium }}</h2>

{% if error_message %}
	<h4>{{ error_message }}</h4>
{% endif %}

<ul>
	<li>Location: {{ aquarium.location }}</li>
	<li>Size: {{ aquarium.size }}</li>
	<li>Active Since: {{ aquarium.activeSince }}</li>
	<li>Water Profile: {{ aquarium.waterProfileID }}</li>
</ul>

<div id="equipment">
<h3>Equipment</h3>

<table>
	<tr>
		<th class="equipmentName">Name</th>
		<th class="equipmentDate">Date Installed</th>
		<th class="equipmentMaintInt">Maint Interval (Days)</th>
		<th class="equipmentLastMaint">Last Maint</th>
		<th class="equipmentNextMaint">Next Maint (Days)</th>
		<th class="equipmentComments">Comments</th>
	</tr>
	{% for item in equipment %}
		<tr>
			<td>
				{% if item.url %}
					<a href="{{ item.url }}">{{ item.name }}</a>
				{% else %}
					{{ item.name }}
				{% endif %}
			</td>
			<td>{{ item.installDate }}</td>
			<td>
				{% if item.maintenanceInterval %}
					{{ item.maintenanceInterval }}
				{% else %}
					N/A
				{% endif %}
			</td>
			<td>
				{% if item.lastMaint %}
					{{ item.lastMaint }}
				{% else %}
					&nbsp;
				{% endif %}
			</td>
			{% if item.nextMaint != None %}
				{% if item.nextMaint <= 0 %}
					<td class="equipmentMaintOverdue">
				{% else %}
					<td>
				{% endif %}
				{{ item.nextMaint }}
				</td>
			{% else %}
				<td>&nbsp;</td>
			{% endif %}

			<td>{{ item.comments }}</td>
		</tr>
    {% empty %}
	<tr><td colspan="4">No Equipment Found</td></tr>
	{% endfor %}
</table>

</div>

<div id="waterLogs">

<h3>Water Logs</h3>

<table>
	<tr>
		<th class="testedOn">Tested On</th>
		<th class="temperature">Temperature (C)</th>
		<th class="ammonia">Ammonia</th>
		<th class="nitrites">Nitrites</th>
		<th class="nitrates">Nitrates</th>
		<th class="pH">pH</th>
		<th class="KH">KH</th>
		<th class="amountExchanged">Water Exchanged</th>
		<th class="comments">Comments</th>
	</tr>
    {% for log in latest_water_logs %}
		<tr>
        	<td class="testedOn">{{ log.testedOn }}</td>

			{# Temperature #}
			{% if log.temperature != None %}
        		<td>{{ log.temperature }} C</td>
			{% else %}
				<td>&nbsp;</td>
			{% endif %}
			
			{# Ammonia #}
			{% if log.ammonia != None %}
				{% if log.ammonia >= 8.0 %}
					<td class="ammonia800">
				{% elif log.ammonia >= 4.0 %}
					<td class="ammonia400">
				{% elif log.ammonia >= 2.0 %}
					<td class="ammonia200">
				{% elif log.ammonia >= 1.0 %}
					<td class="ammonia100">
				{% elif log.ammonia >= 0.5 %}
					<td class="ammonia050">
				{% elif log.ammonia >= 0.25 %}
					<td class="ammonia025">
				{% else %}
					<td class="ammonia000">
				{% endif %}
				{{ log.ammonia }} ppm
				</td>
			{% else %}
				<td>&nbsp;</td>
			{% endif %}
			
			{# Nitrites #}
			{% if log.nitrites != None %}
				{% if log.nitrites >= 5.0 %}
					<td class="nitrite500">
				{% elif log.nitrites >= 2.0 %}
					<td class="nitrite200">
				{% elif log.nitrites >= 1.0 %}
					<td class="nitrite100">
				{% elif log.nitrites >= 0.50 %}
					<td class="nitrite050">
				{% elif log.nitrites >= 0.25 %}
					<td class="nitrite025">
				{% else %}
					<td class="nitrite000">
				{% endif %}
				{{ log.nitrites }} ppm
				</td>
			{% else %}
				<td>&nbsp;</td>
			{% endif %}

			{# Nitrates #}
			{% if log.nitrates != None %}
				{% if log.nitrates >= 160 %}
					<td class="nitrate160">
				{% elif log.nitrates >= 80 %}
					<td class="nitrate080">
				{% elif log.nitrates >= 40 %}
					<td class="nitrate040">
				{% elif log.nitrates >= 20 %}
					<td class="nitrate020">
				{% elif log.nitrates >= 10 %}
					<td class="nitrate010">
				{% elif log.nitrates >= 5 %}
					<td class="nitrate005">
				{% else %}
					<td class="nitrate000">
				{% endif %}
				{{ log.nitrates }} ppm
				</td>
			{% else %}
				<td>&nbsp;</td>
			{% endif %}

        	<td class="pH">
				{% if log.pH != None %}
					{{ log.pH }}
				{% else %}
					&nbsp;
				{% endif %}
			</td>
        	<td class="KH">
				{% if log.KH != None %}
					{{ log.KH }}
				{% else %}
					&nbsp;
				{% endif %}
			</td>
        	<td class="amountExchanged">
				{% if log.amountExchanged %}
					{{ log.amountExchanged }} L
				{% else %}
					&nbsp;
				{% endif %}
			</td>
        	<td class="comments"><p>{{ log.comments }}</p></td>
		</tr>
    {% empty %}
	<tr><td colspan="9">No log-data available</td></tr>
	{% endfor %}
</table>

<h4>Add Water Test Sample</h4>

<form action="/aquarilog/aquarium/{{ aquarium.aquariumID }}/" method="post">
	{% csrf_token %}
	{{ water_log_form.as_p }}
	<input type="submit" value="Add Sample" />
</form>




{% include "footer.html" %}